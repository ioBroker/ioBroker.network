(this["webpackJsonpnetwork-admin"]=this["webpackJsonpnetwork-admin"]||[]).push([[0],{150:function(e){e.exports=JSON.parse('{"a":"0.1.0"}')},172:function(e,t,s){},221:function(e){e.exports=JSON.parse('{"Options":"Options","Objects":"Objects","URL Server":"Server URL","Server":"Server","Send interval":"Send interval","seconds":"seconds","De-bounces":"De-bounces","debounce":"de-bounce","ms":"ms"}')},222:function(e){e.exports=JSON.parse('{"Options":"Optionen","Objects":"Objekte","URL Server":"Server-URL","Server":"Server","Send interval":"Sendeintervall","seconds":"Sekunden","De-bounces":"De-Bounces","debounce":"abprallen","ms":"ms"}')},223:function(e){e.exports=JSON.parse('{"Options":"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b","Objects":"\u041e\u0431\u044a\u0435\u043a\u0442\u044b","URL Server":"URL-\u0430\u0434\u0440\u0435\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430","Server":"\u0421\u0435\u0440\u0432\u0435\u0440","Send interval":"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438","seconds":"\u0441\u0435\u043a\u0443\u043d\u0434\u044b","De-bounces":"De-bounces","debounce":"\u0443\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0434\u0440\u0435\u0431\u0435\u0437\u0433\u0430","ms":"\u043c\u0441"}')},224:function(e){e.exports=JSON.parse('{"Options":"Op\xe7\xf5es","Objects":"Objetos","URL Server":"URL do servidor","Server":"Servidor","Send interval":"Intervalo de envio","seconds":"segundos","De-bounces":"De-bounces","debounce":"de-salto","ms":"ms"}')},225:function(e){e.exports=JSON.parse('{"Options":"Opties","Objects":"Voorwerpen","URL Server":"Server-URL","Server":"Server","Send interval":"Verzend interval","seconds":"seconden","De-bounces":"De-bounces","debounce":"de-bounce","ms":"ms"}')},226:function(e){e.exports=JSON.parse('{"Options":"Options","Objects":"Objets","URL Server":"URL du serveur","Server":"Serveur","Send interval":"Intervalle d\'envoi","seconds":"secondes","De-bounces":"De-rebondit","debounce":"rebondir","ms":"ms"}')},227:function(e){e.exports=JSON.parse('{"Options":"Opzioni","Objects":"Oggetti","URL Server":"URL del server","Server":"server","Send interval":"Invia intervallo","seconds":"secondi","De-bounces":"De-bounces","debounce":"de-rimbalzo","ms":"ms"}')},228:function(e){e.exports=JSON.parse('{"Options":"Opciones","Objects":"Objetos","URL Server":"URL del servidor","Server":"Servidor","Send interval":"Intervalo de env\xedo","seconds":"segundos","De-bounces":"De-bounces","debounce":"rebote","ms":"ms"}')},229:function(e){e.exports=JSON.parse('{"Options":"Opcje","Objects":"Obiekty","URL Server":"URL serwera","Server":"serwer","Send interval":"Interwa\u0142 wysy\u0142ania","seconds":"sekundy","De-bounces":"De-bounces","debounce":"Obali\u0107","ms":"ms"}')},230:function(e){e.exports=JSON.parse('{"Options":"\u9009\u4ef6","Objects":"\u5bf9\u8c61","URL Server":"\u670d\u52a1\u5668\u7f51\u5740","Server":"\u670d\u52a1\u5668","Send interval":"\u53d1\u9001\u95f4\u9694","seconds":"\u79d2","De-bounces":"\u53bb\u5f39\u8df3","debounce":"\u53bb\u6296\u52a8","ms":"ms"}')},231:function(e,t,s){"use strict";s.r(t);s(0);var i=s(15),n=s.n(i),a=s(266),r=s(85),c=(s(172),s(96)),o=s.n(c),l=s(97),d=s.n(l),h=s(5),p=s(276),b=s(279),u=s(277),f=s(128),j=s(121),g=s(120),v=s(278),O=s(119),S=s(118),w=s(272),m=s(273),x=s(281),I=s(98),D=s(274),k=s(275),C=s(282),y=s(148),W=s.n(y),N=s(149),P=s.n(N),R=s(142),J=s.n(R),T=s(143),L=s.n(T),U=s(140),q=s.n(U),F=s(141),E=s.n(F),B=s(138),z=s.n(B),A=s(139),$=s.n(A),V=s(136),H=s.n(V),G=s(137),K=s.n(G),M=s(146),Q=s.n(M),X=s(145),Y=s.n(X),Z=s(144),_=s.n(Z),ee=s(133),te=s.n(ee),se=s(99),ie=s.n(se),ne=s(13),ae=s.n(ne),re=s(7);const ce=(e,t)=>{let s;const i=(e||"").match(/^([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)$/);return i?(s=!i.slice(1).find((e=>parseInt(e)<0||parseInt(e)>255)),t&&s&&(s=(4294967296+(parseInt(i[1],10)<<24)+(parseInt(i[2],10)<<16)+(parseInt(i[3],10)<<8)+parseInt(i[4],10)).toString(2).match(/^1+0+$/),s&&!parseInt(i[1],10)&&(s=!1))):s=!1,s},oe=(e,t)=>{const s={marginRight:8};return t>-67?e?Object(re.jsx)(H.a,{style:s}):Object(re.jsx)(K.a,{style:s}):t>-70?e?Object(re.jsx)(z.a,{style:s}):Object(re.jsx)($.a,{style:s}):t>-80?e?Object(re.jsx)(q.a,{style:s}):Object(re.jsx)(E.a,{style:s}):e?Object(re.jsx)(J.a,{style:s}):Object(re.jsx)(L.a,{style:s})};class le extends te.a{constructor(e){const t={};t.translations={en:s(221),de:s(222),ru:s(223),pt:s(224),nl:s(225),fr:s(226),it:s(227),es:s(228),pl:s(229),"zh-cn":s(230)},t.doNotLoadAllObjects=!0,t.adapterName="network",super(e,t),this.refreshWiFi=()=>{let e=null;return this.socket.sendTo("network.".concat(this.instance),"wifiConnections",null).then((t=>(e=t,this.setState({wifiConnections:t}),this.socket.sendTo("network.".concat(this.instance),"wifi",null)))).then((t=>{t.length&&(t=t.filter((e=>""!==e.ssid.trim())).sort(((t,s)=>{const i=!(!e.length||t.ssid!==e[0].ssid),n=!(!e.length||s.ssid!==e[0].ssid);return i?-1:n?1:s.quality-t.quality})),this.setState({wifi:t}))}))},this.setInterfaceParam=(e,t,s)=>{const i=JSON.parse(JSON.stringify(this.state.interfacesChanged));i[e][t]=s,this.setState({interfacesChanged:i})},this.setDns=(e,t,s)=>{const i=JSON.parse(JSON.stringify(this.state.interfacesChanged));i[e].dns[t]=s,this.setState({interfacesChanged:i})},this.addDns=e=>{const t=JSON.parse(JSON.stringify(this.state.interfacesChanged));t[e].dns.push(""),this.setState({interfacesChanged:t})},this.removeDns=(e,t)=>{const s=JSON.parse(JSON.stringify(this.state.interfacesChanged));s[e].dns.splice(t,1),this.setState({interfacesChanged:s})},this.sendData=(e,t)=>{this.setState({processing:!0}),this.socket.sendTo("network.".concat(this.instance),"changeInterface",{rootPassword:t,data:this.state.interfacesChanged[e]}).then((e=>{this.setState({processing:!1}),e?(this.props.enqueueSnackbar(ae.a.t("Interface updated"),{variant:"success"}),this.refresh()):this.props.enqueueSnackbar(ae.a.t("Interface not updated"),{variant:"error"})})),window.location.hostname===this.state.interfaces[e].ip4&&this.state.interfacesChanged[e].ip4!==this.state.interfaces[e].ip4&&(window.location.href="http://".concat(this.state.interfacesChanged[e].ip4,":").concat(window.location.port))},this.connect=(e,t)=>(this.setState({processing:!0}),this.socket.sendTo("network.".concat(this.instance),"wifiConnect",{ssid:e,password:t,iface:this.state.interfacesChanged[this.getSelectedTab()].iface}).then((()=>{this.refreshWiFi();const t=Date.now();this.pendingWifiInterval=setInterval((()=>{this.state.wifiConnections.length&&e===this.state.wifiConnections[0].ssid?(this.props.enqueueSnackbar("".concat(e," ").concat(ae.a.t("connected")),{variant:"success"}),clearInterval(this.pendingWifiInterval),this.pendingWifiInterval=null,this.refresh().then((()=>this.setState({processing:!1})))):Date.now()-t>4e4?(this.props.enqueueSnackbar("".concat(e," ").concat(ae.a.t("not connected")),{variant:"error"}),clearInterval(this.pendingWifiInterval),this.pendingWifiInterval=null,this.refresh().then((()=>this.setState({processing:!1})))):this.refreshWiFi()}),1e3)}))),this.disconnect=()=>(this.setState({processing:!0}),this.socket.sendTo("network.".concat(this.instance),"wifiDisconnect",{iface:this.state.interfacesChanged[this.getSelectedTab()].iface}).then((()=>{this.refreshWiFi();const e=Date.now();this.pendingWifiInterval=setInterval((()=>{0===this.state.wifiConnections.length?(this.props.enqueueSnackbar(ae.a.t("Wi-fi disconnected"),{variant:"success"}),clearInterval(this.pendingWifiInterval),this.pendingWifiInterval=null,this.refresh().then((()=>this.setState({processing:!1})))):Date.now()-e>4e4?(this.props.enqueueSnackbar(ae.a.t("Wi-fi disconnected"),{variant:"error"}),clearInterval(this.pendingWifiInterval),this.pendingWifiInterval=null,this.refresh().then((()=>this.setState({processing:!1})))):this.refreshWiFi()}),1e3)}))),this.pendingWifiInterval=null,this.scanWifiInterval=null}componentWillUnmount(){this.pendingWifiInterval&&clearInterval(this.pendingWifiInterval),this.pendingWifiInterval=null,this.scanWifiInterval&&clearInterval(this.scanWifiInterval),this.scanWifiInterval=null}onConnectionReady(){this.setState({interfaces:null,interfacesChanged:[],wifi:[],dns:[],wifiConnections:[],sudoDialog:!1,sudoDialogPassword:"",wifiDialog:!1,wifiDialogPassword:"",scanWifi:!1,processing:!1,firstRequest:0},(()=>this.refresh()))}refresh(){return 0===this.state.firstRequest&&this.setState({firstRequest:1}),this.socket.sendTo("network.".concat(this.instance),"interfaces",null).then((e=>(e.sort(((e,t)=>e.mac>t.mac?-1:1)),e.sort(((e,t)=>"wired"===e.type?-1:1)),e.sort(((e,t)=>e.virtual?1:-1)),e=(e=e.filter((e=>"127.0.0.1"!==e.ip4))).map((e=>("string"===typeof e.dhcp&&(e.dhcp=JSON.parse(e.dhcp)),e))),this.setState({interfaces:e,interfacesChanged:JSON.parse(JSON.stringify(e))}),this.refreshWiFi()))).then((()=>this.socket.sendTo("network.".concat(this.instance),"dns",null))).then((e=>this.setState({dns:e,firstRequest:2})))}getSelectedTab(){return this.state.selectedTab?this.state.selectedTab:"0"}renderRootDialog(){return Object(re.jsxs)(f.a,{open:!1!==this.state.sudoDialog,onClose:()=>this.setState({sudoDialog:!1,sudoDialogPassword:""}),children:[Object(re.jsx)(j.a,{children:ae.a.t("Enter sudo password")}),Object(re.jsx)(g.a,{children:Object(re.jsx)(v.a,{value:this.state.sudoDialogPassword,onChange:e=>this.setState({sudoDialogPassword:e.target.value}),type:"password"})}),Object(re.jsxs)(O.a,{children:[Object(re.jsx)(S.a,{variant:"contained",color:"primary",disabled:!this.state.sudoDialogPassword,onClick:()=>{this.sendData(this.state.sudoDialog,this.state.sudoDialogPassword),this.setState({sudoDialog:!1,sudoDialogPassword:""})},children:ae.a.t("Send")}),Object(re.jsx)(S.a,{variant:"contained",onClick:()=>this.setState({sudoDialog:!1,sudoDialogPassword:""}),startIcon:Object(re.jsx)(_.a,{}),children:ae.a.t("Cancel")})]})]})}renderWifiDialog(){return Object(re.jsxs)(f.a,{open:!1!==this.state.wifiDialog,onClose:()=>this.setState({wifiDialog:!1,wifiDialogPassword:""}),children:[Object(re.jsx)(j.a,{children:ae.a.t("Enter wifi password")}),Object(re.jsx)(g.a,{children:Object(re.jsx)(v.a,{value:this.state.wifiDialogPassword,onChange:e=>this.setState({wifiDialogPassword:e.target.value}),type:"password"})}),Object(re.jsxs)(O.a,{children:[Object(re.jsx)(S.a,{variant:"contained",onClick:()=>this.setState({wifiDialog:!1,wifiDialogPassword:""}),children:ae.a.t("Cancel")}),Object(re.jsx)(S.a,{variant:"contained",color:"primary",disabled:!this.state.wifiDialogPassword,onClick:()=>{this.connect(this.state.wifiDialog,this.state.wifiDialogPassword),this.setState({wifiDialog:!1,wifiDialogPassword:""})},children:ae.a.t("Send")})]})]})}startsWifiScan(e,t){!0===e?(this.scanWifiInterval=this.scanWifiInterval||setInterval(this.refreshWiFi,4e3),this.setState({scanWifi:!0},(()=>t&&t()))):!1===e?(this.scanWifiInterval&&clearInterval(this.scanWifiInterval),this.scanWifiInterval=null,this.setState({scanWifi:!1},(()=>t&&t()))):this.startsWifiScan(!this.state.scanWifi,t)}renderInterface(e,t){let s,i=!0,n=!0,a=!0;return e.dhcp?s=e.dhcp!==this.state.interfaces[t].dhcp:(i=ce(e.ip4),n=ce(e.ip4subnet,!0),a=ce(e.gateway),s=i&&n&&a,s&&(s=e.dhcp!==this.state.interfaces[t].dhcp||(e.ip4!==this.state.interfaces[t].ip4||e.ip4subnet!==this.state.interfaces[t].ip4subnet||e.gateway!==this.state.interfaces[t].gateway))),Object(re.jsx)(re.Fragment,{children:Object(re.jsxs)(w.a,{container:!0,children:[Object(re.jsxs)(w.a,{item:!0,className:this.props.classes.gridItem,children:[Object(re.jsx)(m.a,{control:Object(re.jsx)(x.a,{disabled:this.state.processing||!e.editable,checked:e.dhcp,onChange:e=>{e.target.checked&&(this.setInterfaceParam(t,"ip4",this.state.interfaces[t].ip4),this.setInterfaceParam(t,"ip4subnet",this.state.interfaces[t].ip4subnet),this.setInterfaceParam(t,"gateway",this.state.interfaces[t].gateway)),this.setInterfaceParam(t,"dhcp",e.target.checked)}}),label:ae.a.t("DHCP")}),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)("h4",{children:"IPv4"}),Object(re.jsx)(v.a,{className:this.props.classes.input,value:e.ip4,error:!i,label:ae.a.t("IPv4"),onChange:e=>this.setInterfaceParam(t,"ip4",e.target.value),disabled:e.dhcp||!e.editable,helperText:i?"":ae.a.t("Invalid IP address")}),Object(re.jsx)(v.a,{className:this.props.classes.input,value:e.ip4subnet,error:!n,label:ae.a.t("IPv4 netmask"),onChange:e=>this.setInterfaceParam(t,"ip4subnet",e.target.value),disabled:e.dhcp||!e.editable,helperText:n?"":ae.a.t("Invalid netmask")}),Object(re.jsx)(v.a,{className:this.props.classes.input,value:e.gateway,error:!a,label:ae.a.t("Default gateway"),onChange:e=>this.setInterfaceParam(t,"gateway",e.target.value),disabled:e.dhcp||!e.editable,helperText:a?"":ae.a.t("Invalid default gateway")}),Object(re.jsx)("h4",{children:"IPv6"}),Object(re.jsx)(v.a,{className:this.props.classes.input,value:e.ip6,label:ae.a.t("IPv6"),disabled:!0}),Object(re.jsx)(v.a,{value:e.ip6subnet,label:ae.a.t("IPv6 netmask"),disabled:!0}),Object(re.jsx)("h4",{children:"DNS"})]}),e.dns&&e.dns.map(((s,i)=>Object(re.jsxs)("div",{children:[Object(re.jsx)(v.a,{value:s,label:ae.a.t("DNS record"),onChange:e=>this.setDns(t,i,e.target.value),disabled:e.dhcp||!e.editable}),e.editable&&!e.dhcp&&e.dns&&e.dns.length>1?Object(re.jsx)(I.a,{onClick:()=>this.removeDns(t,i),children:Object(re.jsx)(Y.a,{})}):null]},i))),e.editable&&!e.dhcp?Object(re.jsx)(I.a,{onClick:()=>this.addDns(t),title:ae.a.t("Add DNS record"),children:Object(re.jsx)(Q.a,{})}):null,e.editable&&!e.dhcp?Object(re.jsx)("br",{}):null,e.editable?Object(re.jsx)(S.a,{variant:"contained",color:"primary",disabled:!s||this.state.processing,onClick:()=>this.sendData(t,""),children:ae.a.t("Save")}):null]}),"wired"===e.type?null:Object(re.jsxs)(w.a,{item:!0,className:this.props.classes.gridItem,children:[this.state.processing||this.state.firstRequest<2?Object(re.jsx)(D.a,{}):null,Object(re.jsx)(m.a,{control:Object(re.jsx)(k.a,{disabled:this.state.processing,checked:this.state.scanWifi,onChange:()=>this.startsWifiScan()}),label:ae.a.t("Wifi scan")}),this.renderWifi()]})]})})}renderWifi(){return this.state.wifi.map(((e,t)=>{const s=!(!this.state.wifiConnections.length||e.ssid!==this.state.wifiConnections[0].ssid);return Object(re.jsxs)("div",{children:[Object(re.jsxs)(S.a,{variant:s?"contained":void 0,color:s?"primary":void 0,disabled:s||this.state.processing,title:s?"":ae.a.t("Click to connect"),onClick:()=>this.startsWifiScan(!1,(()=>{e.security.includes("Open")?this.connect(e.ssid,""):this.setState({wifiDialog:e.ssid})})),children:[Object(re.jsx)(C.a,{title:e.quality+" dBm",children:oe(e.security.includes("Open"),parseInt(e.quality))}),e.ssid]}),s?Object(re.jsx)(S.a,{onClick:()=>{this.startsWifiScan(!1,(()=>this.disconnect()))},variant:"outlined",className:this.props.classes.buttonIcon,disabled:this.state.processing,children:ae.a.t("Disconnect")}):null]},t)}))}render(){return this.state.loaded?this.state.interfaces?Object(re.jsx)(a.a,{theme:this.state.theme,children:Object(re.jsxs)("div",{className:"App",style:{background:"dark"===this.state.themeType?"#000":"#FFF",color:"dark"===this.state.themeType?"#EEE":"#111"},children:[Object(re.jsxs)(p.a,{position:"static",children:[Object(re.jsx)(b.a,{value:this.getSelectedTab(),onChange:(e,t)=>this.selectTab(t,t),variant:"scrollable",children:this.state.interfaces.map(((e,t)=>Object(re.jsx)(u.a,{value:t.toString(),label:Object(re.jsxs)("div",{className:this.props.classes.tabContainer,children:["wired"===e.type?Object(re.jsx)(W.a,{className:this.props.classes.buttonIcon}):Object(re.jsx)(P.a,{className:this.props.classes.buttonIcon}),e.iface]})},t)))}),this.state.interfaces.length?null:ae.a.t("No network interfaces detected!")]}),Object(re.jsx)("div",{className:this.props.classes.tabContent,children:this.renderInterface(this.state.interfacesChanged[this.getSelectedTab()],this.getSelectedTab())}),this.renderRootDialog(),this.renderWifiDialog()]})}):Object(re.jsx)(a.a,{theme:this.state.theme,children:Object(re.jsx)(D.a,{})}):Object(re.jsx)(a.a,{theme:this.state.theme,children:Object(re.jsx)(ie.a,{theme:this.state.themeType})})}}var de=Object(r.b)(Object(h.a)((()=>({root:{},tabContent:{padding:10,overflow:"auto",height:"calc(100% - 64px)"},tabContainer:{display:"flex"},buttonIcon:{marginLeft:10},gridItem:{width:"50%",maxWidth:500},input:{display:"block",marginBottom:10}})))(le));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var he=s(150);window.adapterName="network";let pe=d.a.getThemeName();console.log("iobroker.".concat(window.adapterName,"@").concat(he.a,' using theme "').concat(pe,'"')),function e(){return n.a.render(Object(re.jsx)(a.a,{theme:o()(pe),children:Object(re.jsx)(r.a,{children:Object(re.jsx)(de,{common:{},onThemeChange:t=>{pe=t,e()}})})}),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}))}},[[231,1,2]]]);
//# sourceMappingURL=main.946fc675.chunk.js.map